#! /bin/sh

# Set window manager name for Java applications compatibility
wmname LG3D &

# Start VMware user wrapper if available
vmware-user-suid-wrapper &

# Start sxhkd if not already running
pgrep -x sxhkd > /dev/null || sxhkd &

# Define desktops
bspc monitor -d I II III IV V VI VII VIII IX X

# Window border and gap settings
bspc config border_width         2
bspc config window_gap          12

# Split ratio for tiled windows
bspc config split_ratio          0.52

# Monocle mode settings
bspc config borderless_monocle   true
bspc config gapless_monocle      true

# Focus and pointer behavior
bspc config focus_follows_mouse  true
bspc config pointer_follows_focus true

# Application specific rules
bspc rule -a Gimp desktop='^8' state=floating follow=on
bspc rule -a Chromium desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off

# ================================================
# Set the Wallpaper
# ================================================

# Wallpaper directory
WALLPAPER_DIR="$HOME/Pictures/wallpapers"

# Function to change wallpaper randomly
change_wallpaper() {
  if [ -d "$WALLPAPER_DIR" ]; then
    # Select a random image from the folder and set it as the background
    feh --randomize --bg-fill "$WALLPAPER_DIR"/*
  else
    echo "Wallpaper directory not found: $WALLPAPER_DIR"
  fi
}

# Change wallpaper initially when starting
change_wallpaper

# Wallpaper change interval in seconds (e.g., 10 minutes = 600 seconds)
INTERVAL=600

# Loop to change the wallpaper every INTERVAL seconds
change_wallpaper_periodically() {
  while true; do
    change_wallpaper
    sleep $INTERVAL
  done &
}

# Start periodic wallpaper changes
change_wallpaper_periodically